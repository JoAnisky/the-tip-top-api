services:
   app:
    build:
        context: .
        dockerfile: .docker/Dockerfile
        target: ${APP_ENV:-dev}
    container_name: symfony-app
    environment:
        APP_ENV: ${APP_ENV:-dev}
        APP_DEBUG: ${APP_DEBUG:-1}
        DOMAIN: ${DOMAIN:-localhost}
    volumes:
        - "./traefik/config/traefik.${APP_ENV:-dev}.yml:/etc/traefik/traefik.yml:ro"
    networks:
        - web
        - mysql_network
    labels:
        - "traefik.enable=true"
        - "traefik.http.routers.app.rule=Host(`${DOMAIN:-localhost}`)"

networks:
    web:
        external: true
    mysql_network:
        external: true
